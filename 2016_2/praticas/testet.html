<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>
<h1 id="teste-t-no-r">Teste-t no R</h1>
<p>A pergunta que nos propusemos a responder em aula foi de quanto pesa uma andorinha. Para isso, fomos à campo, coletamos e pesamos 100 indivíduos. Os dados obtidos foram tabulados e se encontram nesta <a href="andorinhas.csv">planilha</a>.</p>
<h2 id="entrando-os-dados">Entrando os dados</h2>
<p>Vamos começar carregando os dados da planilha no R. Para isso, use a função <em>read.csv</em>. Execute o comando <code>help(read.csv)</code> caso seja necessário.</p>
<p>Para que sua planilha fique salva e você possa utilizá-la inúmeras vezes, você deve atribuir a leitura do .csv para um objeto. Exemplo:</p>
<pre class="{r}"><code>andorinhas = read.csv(&quot;andorinhas.csv&quot;)</code></pre>
<p>Note que para esse comando funcionar você deve ter ajustado seu diretório de trabalho para o diretório onde o arquivo se encontra. Utilize a função <em>setwd</em> para esse fim.</p>
<h2 id="calculando-medidas-de-tendência-central-e-variabilidade">Calculando medidas de tendência central e variabilidade</h2>
<p>Primeiramente, vamos dar uma olhada geral nos dados utilizando o comando <em>head</em>. Agora que você já sabe a estrutura do seu <em>data.frame</em> podemos prosseguir. Podemos calcular a média usando a função <em>mean</em>, a variância com <em>var</em> e o desvio padrão com <em>sd</em> ou tirando a raíz quadrada da variância com <em>sqrt</em>. Note que nosso <em>data.frame</em> possui duas colunas, mas o que nos interessa no momento é apenas a coluna <strong>peso</strong>. Uma maneira de extrair apenas essa coluna é utilizando <em>$</em>:</p>
<pre class="{r}"><code>andorinhas$peso #imprime o vetor dos pesamos
media = mean(andorinhas$peso) # calcula a média dos pesos e atribui à variável média
dp = sd(andorinhas$peso) # calcula o desvio padrão e atribui à variável dp
cv = dp/media # calcula o coeficiente de variação e atribui à variável cv</code></pre>
<p>Tente calcular o desvio padrão tirando a raíz quadrada da variância e salve num objeto chamado <code>dp2</code>. Agora execute o comando abaixo e interprete-o:</p>
<pre class="{r}"><code>dp == dp2</code></pre>
<p>Qual foi o resultado? As duas maneiras de calcular o desvio padrão são equivalentes? O que o operador <code>==</code> faz?</p>
<h2 id="teste-t">Teste-t</h2>
<p>Depois de explorarmos um pouco nossos dados, podemos realizar um teste estatístico. Suponha que previamente se sabia que andorinhas do México pesavam 12g, mas sabemos que as andorinhas brasileiras são maiores. Queremos testar então se as andorinhas mexicanas e brasileiras possuem pesos diferentes. A estatística de interesse que podemos usar é a média. Então, nossa hipótese nula estatística deve ser de que andorinhas brasileiras pesam 12g. Se refutarmos H0, ficamos com a hipótese alternativa de que andorinhas brasileiras têm, em média, peso (<span class="math inline"><em>μ</em><sub><em>b</em></sub></span>) diferente das andorinhas mexicanas.</p>
<p><br /><span class="math display"><em>H</em><sub>0</sub> : <em>μ</em><sub><em>b</em></sub> = 12</span><br /></p>
<p><br /><span class="math display"><em>H</em><sub>1</sub> : <em>μ</em><sub><em>b</em></sub> ≠ 12</span><br /></p>
<p>Dê uma olhada na função <em>t.test</em> do R antes de prosseguir (<code>?t.test</code>). Precisamos de um vetor <em>x</em> com os valores de peso, hipótese alternativa <em>two.sided</em> e <em>mu</em> = 12. Tente rodar sozinho antes de prosseguir.</p>
<pre class="{r}"><code>t.test(x = andorinhas$peso, alternative = &quot;two.sided&quot;, mu = 12)</code></pre>
<p>Segue o resultado que deverá aparecer no seu console:</p>
<pre class="{r}"><code>One Sample t-test

data:  andorinhas$peso
t = 14.171, df = 99, p-value &lt; 2.2e-16
alternative hypothesis: true mean is not equal to 12
95 percent confidence interval:
14.67358 15.54420
sample estimates:
mean of x
15.10889</code></pre>
<p>Tente interpretar o que o R nos deu como resultado. Utilize o R apenas como calculadora e calcule a estatística <em>t</em> e a média dos pesos das andorinhas. O novo resultado bate com o que obtivemos anteriormente? Você refutaria a sua hipótese nula com esse p-valor? Por quê?</p>
<p>Um outro resultado interessante que o R mostra é a estimativa intervalar, ou intervalo de confiança. A idéia do tamanho amostral e do desvio padrão são incorporados nessa estimativa. O que você acha que aconteceria se o tamanho amostral fosse menor? E se o desvio padrão fosse maior?</p>
<h2 id="teste-t-com-duas-populações">Teste-t com duas populações</h2>
<p>No exercício anterior comparamos a média do peso das andorinhas brasileiros com um valor conhecido a priori de 12g. No entanto, com dados reais quase nunca teremos um valor conhecido a priori. Quando quisermos comparar duas populações devemos utilizar o teste-t de duas amostras.</p>
<p>Uma outra questão que pode surgir ao olharmos mais atentamente aos nossos dados é a de dimorfismo sexual. Anteriormente, fizemos uma média pra todas as andorinhas, sem levar em conta o sexo. Será que há diferença no peso médio entre os sexos? Veremos!</p>
<p>Primeiramente, vamos separar os dados de machos e fêmeas em dois objetos distintos. Tente usar a função <em>subset</em> para fazer isso.</p>
<pre class="{r}"><code>machos = subset(andorinhas, andorinhas$sexo == &quot;M&quot;)
femeas = subset(andorinhas, andorinhas$sexo == &quot;F&quot;)</code></pre>
<p>Não prossiga até ter certeza que entendeu o que os dois comandos acima fazem. Vamos agorar explorar nossos dados, fazendo as medidas de tendência central e variabilidade. Olhando só para essas medidas, você diria que há diferença entre o peso médio de machos e fêmeas?</p>
<p>Pense sozinho na hipótese nula estatística e realize o teste-t para ver se há diferença entre os sexos. Lembre-se de olhar o <em>help</em> da função <em>t.test</em> para realizar o teste. Você diria que essa espécie apresenta dimorfismo sexual pra característica peso?</p>
<h2 id="explorando-graficamente">Explorando graficamente</h2>
<p>Antes mesmo de fazer um teste estatístico temos que conhecer os dados com que estamos lidando. Uma maneira bem prática e eficaz de fazer isso é com gráficos exploratórios. Vamos aprender como fazer alguns gráficos com o R, que é uma ferramenta poderosa para esse fim.</p>
<h4 id="boxplot">Boxplot</h4>
<p>Um dos gráficos mais úteis e que melhor resume variáveis contínuas é o <em>boxplot</em>. Esse gráfico sumariza algumas estatísticas de uma maneira visual bem intuitiva. O boxplot é composto por 5 medidas: limite superior, <span class="math inline">3<sup><em>o</em></sup></span> quartil, mediana, <span class="math inline">1<sup><em>o</em></sup></span> quartil e limite inferior. Como interpretamos esse gráfico? Na caixa central, encontra-se 50% das nossas observações. Observando a simetria entre os dois lados a partir da mediana podemos saber se nossos dados são simétricos ou assimétricos. Só aqui já temos uma boa noção da distribuição dos nossos dados.</p>
<p>Fazer um <em>boxplot</em> no R é bem simples. Tente utilizar a função <em>boxplot</em> para fazer um boxplot do peso das andorinhas.</p>
<pre class="{r}"><code>boxplot(andorinhas$peso)</code></pre>
<p>Podemos ainda dividir as observações em classes determinadas por uma varíavel categórica. Nosso <em>data.frame</em> possui duas colunas: peso e sexo. Podemos dividir em dois boxplots, um para fêmeas e outro para machos. Para fazermos isso temos que usar uma notação de fórmula do R: <code>y ~ x</code>. A nossa varíavel y seria o peso das andorinhas e a variável x o sexo. Tente fazer sozinho o boxplot por sexo.</p>
<h4 id="histograma">Histograma</h4>
<p>Outro gráfico bastante utilizado e que nos mostra mais detalhadamente a distribuição dos dados é o histograma. Para fazermos um histograma no R basta utilizar a função <em>hist</em>. Tente fazer o histograma para a distribuição dos pesos das andorinhas. Você acha que a distribuição se aproxima de uma normal? Faça agora dois histogramas, um para machos e outro para fêmeas. As distribuições se aproximam da normal?</p>
</body>
</html>
